import sys
from tkinter import *
from tkinter import ttk
import tkinter as tk
import random
from funcs import *
from time import sleep
import os
oyundurumu = ""
kelimeler = []
for kelime in open("full.txt","r+",encoding="utf-8").read().split("\n"):
    kelimeler.append(kelime.split(' ')[0])
def yeniden_oyna():
    os.startfile(sys.argv[0])
    sys.exit()
bilgisayar_kelimesi = random.choice(kelimeler)
def oyun_bitti(skor,durum=bool):
    if durum:
        oyunbittimesajılabeli.config(text=f"""
        OYUN BİTTİ
        SEN KAZANDIN
        skor:{skor}
        """)
        donat.config(text="")
        gönder_buton.config(state="disabled")
        yenidenoynalabeli.pack(side="bottom")
        yenidenoynabutonu.pack(side="bottom")
        yenidenoynayıiptalbutonu.pack(side="bottom")
        sleep(3)
        exit()

    if not durum:
        skor -= 1
        oyunbittimesajılabeli.config(text=f"""
        OYUN BİTTİ
        SEN KAYBETTİN
        skor:{skor}
        """)
        donat.config(text="")
        gönder_buton.config(state="disabled")
        yenidenoynalabeli.pack(side="bottom")
        yenidenoynabutonu.pack(side="bottom")
        yenidenoynayıiptalbutonu.pack(side="bottom")

kullanılan_kelimeler = []
mümkün_kelimeler = []
skor = 0
root = Tk()
root.title("Son Harften Kelime Türetme")
root.geometry("521x400")

def bilgisayarın_kelime_bulması(kelime):
    global skor, mümkün_kelimeler, bilgisayar_kelimesi
    kullanılan_kelimeler.append(kelime)
    for mkelime in kelimeler:
        if mkelime.startswith(kelime[-1]) and kullanılan_kelimeler.count(mkelime) == 0:
            mümkün_kelimeler.append(mkelime)
    bilgisayar_kelimesi = random.choice(mümkün_kelimeler)
    donat.config(text=bilgisayar_kelimesi)
    
    kullanılan_kelimeler.append(bilgisayar_kelimesi)

def bizim_kelime_göndermemiz():

    global bilgisayar_kelimesi,skor,mümkün_kelimeler
    kullanıcıKelimesi = giris_entry.get()
    skor += 1
    donat.config(text=bilgisayar_kelimesi)
    kullanılan_kelimeler.append(bilgisayar_kelimesi)
    if kelimeler.count(kullanıcıKelimesi) == 0:
        hatamesajılabeli.config(text=f'{kullanıcıKelimesi}, "diye bir kelime bulunamadı!"')
        oyun_bitti(skor,0)
    if not kullanıcıKelimesi.startswith(bilgisayar_kelimesi[-1]):
        hatamesajılabeli.config(text=f"{bilgisayar_kelimesi[-1]} ile başlayan bir kelime bulmanız gerekiyordu!")
        oyun_bitti(skor,0)
    if kullanıcıKelimesi.endswith("ğ"):
        oyun_bitti(skor,1)
    if bilgisayar_kelimesi.endswith("ğ"):
        hatamesajılabeli.config(text="Bilgisayar ğ ile biten kelime buldu!")
        oyun_bitti(skor,0)
    if kullanılan_kelimeler.count(kullanıcıKelimesi) > 0:
        hatamesajılabeli.config(text=f'{kullanıcıKelimesi}, "kelimesi kullanıldı!"')
        oyun_bitti(skor,0)

    mümkün_kelimeler = []
    donat.config(text="")

    bilgisayarın_kelime_bulması(kelime=kullanıcıKelimesi)

    giris_entry.delete(0,END)
    
    
kullanıcı_giriş_paneli = ttk.Entry()
noidea = tk.Label(text="Kelime giriniz: ")
noidea.pack(side="top")
giris_entry = tk.Entry(fg="#fff",bg="black")
giris_entry.pack(side="top")
çıkış_butonu = tk.Button(text="       Çıkış       ",command=exit,bg="gray",fg="red")
çıkış_butonu.pack(side="left",ipadx=20,ipady=10)
gönder_buton = tk.Button(text="Kelimeyi gönder", fg="lime",bg="gray",command=bizim_kelime_göndermemiz)
gönder_buton.pack(side="right",ipadx=20,ipady=10)
donat = tk.Label(text=bilgisayar_kelimesi)
donat.pack(side="top",pady=30)
oyunbittimesajılabeli = tk.Label(text = "",fg="#9c5106")
oyunbittimesajılabeli.pack(side="bottom")
yenidenoynalabeli = tk.Label(text="Yeniden oyna ?",fg="gold")
yenidenoynabutonu = tk.Button(text="✔",bg="blue",command=yeniden_oyna)
yenidenoynayıiptalbutonu = tk.Button(text="✖",bg="red",command=exit)
hatamesajılabeli = tk.Label(text="")
hatamesajılabeli.pack(side="bottom")

root.mainloop()
